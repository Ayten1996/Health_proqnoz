from flask import Flask, request, jsonify
import streamlit as st
import pandas as pd
import joblib

model = joblib.load('model.pkl')
le_group = joblib.load('le_group.pkl')
le_cat = joblib.load('le_cat.pkl')

def predict_patient(df):
    preds = model.predict(df)
    risk_group_probs = preds[0]
    risk_cat_probs = preds[1]

    risk_group_class = risk_group_probs.argmax(axis=1)[0]
    risk_cat_class = risk_cat_probs.argmax(axis=1)[0]

    risk_group_label = le_group.inverse_transform([risk_group_class])[0]
    risk_cat_label = le_cat.inverse_transform([risk_cat_class])[0]
    return risk_group_label, risk_cat_label

st.title("Risk Prediction App")


fast_blood_sugar = st.number_input('fasting blood sugar', value=97)
cholesterol = st.number_input('Cholesterol', value=239)
ldl = st.number_input('LDL', value=142)
hdl = st.number_input('HDL', value=70)
ast = st.number_input('AST', value=61)
alt = st.number_input('ALT', value=115)
serum_creatinine = st.number_input('serum creatinine', value=1.0)
if st.button('Predict'):
    data = {
        'fast_blood_sugar': [fast_blood_sugar],
        'cholesterol': [cholesterol],
        'ldl': [ldl],
        'hdl': [hdl],
        'ast': [ast],
        'alt': [alt],
        'serum_creatinine': [serum_creatinine]
    }
    df = pd.DataFrame(data)
    risk_group, risk_category = predict_patient(df)
    st.write(f"Risk Group: {risk_group}")
    st.write(f"Risk Category: {risk_category}")